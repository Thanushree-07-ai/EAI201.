import tensorflow as tf
import numpy as np
import matplotlib.pyplot as plt

# Step 1: Get user data points
n = int(input("How many points to enter? "))
x_vals = []
y_vals = []
for i in range(n):
    x = float(input(f"Enter x[{i+1}]: "))
    y = float(input(f"Enter y[{i+1}]: "))
    x_vals.append(x)
    y_vals.append(y)

X = np.array(x_vals, dtype=float)
Y = np.array(y_vals, dtype=float)

# Step 2: Define simple linear model
model = tf.keras.Sequential([
    tf.keras.layers.Dense(units=1, input_shape=[1])
])

# Step 3: Compile with SGD optimizer
model.compile(optimizer=tf.keras.optimizers.SGD(learning_rate=0.05),
              loss='mean_squared_error')

# Step 4: Train the model
print("Training model...")
model.fit(X, Y, epochs=150, verbose=0)
print("Training complete!")

# Step 5: Get learned parameters
w, b = model.layers[0].get_weights()
print(f"Learned line: y = {w[0][0]:.2f}x + {b[0]:.2f}")

# Step 6: Plot data and regression line
plt.scatter(X, Y, label='Data Points')
plt.plot(X, model.predict(X.reshape(-1,1)), color='green', label='Fitted Line')
plt.xlabel('X')
plt.ylabel('Y')
plt.title('Linear Regression with TensorFlow')
plt.legend()
plt.show()
